## Overview

Это Telegram-бот для безопасного хранения учётных данных и других
пользовательских секретов.

Приложение позволяет:

- хранить пароли от сервисов и аккаунтов;
- добавлять произвольные параметры к аккаунтам (логины, токены, заметки);
- помечать параметры как секретные;
- просматривать и управлять сохранёнными данными через Telegram-интерфейс.

### Usage Scenarios

Приложение предназначено для пользователей, которым необходимо:

- централизованно хранить доступы к различным сервисам;
- быстро получать доступ к своим данным через Telegram;
- обеспечить защиту чувствительной информации даже в случае компрометации сервера.

Секретные данные шифруются и могут быть расшифрованы только после дополнительного подтверждения паролем пользователя.

## Модель безопасности

Безопасность является ключевой особенностью приложения.  
Система намеренно разделяет:

- **аутентификацию пользователя**
- **доступ к расшифрованным данным**

Наличие активной сессии не означает автоматический доступ к секретной информации.

---

### Аутентификация

Для аутентификации используется механизм JWT с разделением токенов:

- `access token` имеет ограниченное время жизни и кэшируется на стороне клиента;
- `refresh token` хранится только на сервере и используется для выпуска новых access token;
- реализована ротация токенов — при обновлении access token предыдущий токен становится недействительным;
- пароль пользователя хранится только в виде криптографического хэша.

#### Ротация токенов

Ротация означает, что при обновлении access token сервер выпускает новый токен, а предыдущий теряет силу.  
Это снижает риск повторного использования украденного токена.

#### Баланс безопасности и интерактивности

Access token кэшируется на стороне клиента, чтобы избежать постоянных обращений к серверу — почти все операции требуют авторизации, и повторная аутентификация перед каждым запросом ухудшила бы пользовательский опыт.

При этом refresh token намеренно хранится только на сервере и не передаётся клиенту.  
Это означает, что после истечения срока действия access token потребуется обращение к серверу для его обновления.

Такой подход обеспечивает баланс:

- минимизация сетевых обращений при обычной работе;
- ограничение распространения чувствительных токенов;
- снижение последствий возможной компрометации клиента.

---

### Разблокировка хранилища

Доступ к секретной информации требует отдельного действия — **разблокировки хранилища**.

После ввода пользовательского пароля:
- на сервере временно создаётся мастер-ключ шифрования;
- этот ключ используется как для шифрования новых данных, так и для расшифровки уже сохранённых;
- ключ хранится ограниченное время (TTL);
- по истечении времени требуется повторный ввод пароля.

Таким образом:

> активная сессия ≠ доступ к секретам  
> наличие ключа = возможность читать и писать защищённые данные

---

### Почему это важно

Даже в случае утечек данных или компрометации инфраструктуры злоумышленники получат только зашифрованные данные без возможности их расшифровать.

---

### Архитектурный компромисс

Разделение аутентификации и разблокировки добавляет дополнительный шаг для пользователя (повторный ввод пароля для доступа к секретам).

Однако это даёт принципиальное преимущество:

- пароль пользователя нигде не хранится в открытом виде;
- мастер-ключ не сохраняется постоянно;
- ключ существует только ограниченное время (TTL);
- без явного ввода пароля восстановить ключ невозможно.

Это означает, что даже при большинстве сценариев компрометации
злоумышленник не сможет расшифровать пользовательские данные,
так как узнать пароль он не сможет.

